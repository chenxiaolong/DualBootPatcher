/*
 * Copyright (C) 2014  Andrew Gunnerson <andrewgunnerson@gmail.com>
 *
 * This file is part of DualBootPatcher
 *
 * DualBootPatcher is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * DualBootPatcher is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with DualBootPatcher.  If not, see <http://www.gnu.org/licenses/>.
 */

#include "validcerts.h"

/*
 * Android's "signatures" in /data/system/packages.xml and also in the Java
 * class android.content.pm.Signature are just hexadecimal representations of
 * the signing key's certificate.
 *
 * To get this "signature" from the keystore, run the following command:
 *
 *   $ keytool -alias YOUR_KEY_ALIAS -keystore YOUR_KEYSTORE_FILE -exportcert \
 *         | hexdump -ve '1/1 "%.2x"'; echo
 */

// Certificate for official releases
#define RELEASE_CERT "3082032930820211a00302010202042eab8dd1300d06092a864886f70d01010b05003045310b3009060355040613025553310d300b060355040813044f68696f310e300c06035504071305536f6c6f6e311730150603550403130e5869616f2d4c6f6e67204368656e301e170d3133303930373230343730345a170d3135303930373230343730345a3045310b3009060355040613025553310d300b060355040813044f68696f310e300c06035504071305536f6c6f6e311730150603550403130e5869616f2d4c6f6e67204368656e30820122300d06092a864886f70d01010105000382010f003082010a02820101009b0cdb622c8e39449bc8e1751e866122ba8e61b8683ff160bf2d874c087a22329dca1a253c06799940714be28918bdc3c3c326ca42d7e226723cbe3d480e85628611355f1d5ba1cf451def8f79edaea652aef238e0d1d7661dc7bf666e8591ec901f266d34ba64d8e455f5b810bd11755f1500f0d98f8c98cffc2baaf7e3540275313497fd009615a79f7b9f60d969a26c3abd28e03034d4f843bb5579c6053c6367f4b8dd6f1df6b0b6766586ae902e6b932cc7924f18cdcaecfebc01283cd32e4586e88cdc3463dbeefe7afb19b680dc4607951382c7c3509cabc3745ef48a2ff5da4545be600b126b4cafc280a836499e743d105da8309658934970c487f90203010001a321301f301d0603551d0e0416041496187394f9848ce0de6ce6bdf443413c191e0b43300d06092a864886f70d01010b05000382010100415dbd9fbe93380febcb9822a237cb04549390d4daab6072219e6904f60c2dbc063f42602b52eba29996c36ac958d5a152b2d9d5d3e5a6d95e73825468c921dd0a281655ceb6cbb88412b046c15057fb600feb729d36e08aa1077e9c82388a3719ef144866b25777a493e7f696211eebbf7d368a5b751435faea7545a8f98045a6bca63f3985e98a9b90882c2f0701421aa30330df4b71770178cc71600f8d9808536381587eab7400d21edca77d206d5b7b5b570bcb051b28d34c389b636da9e77d2ccaa9e1d1476bde5f721fdc54993f96cc77d868916dbff0b7b02a012421fb7e8f18d5948fa478df783df49dcc6eef37e0168997afd9fd899a27d13819ee"
// Certificate for continuous integration snapshots
#define CI_CERT      "3082030d308201f5a003020102020402e9ac58300d06092a864886f70d01010b05003037310b30090603550406130255533110300e060355040a1307416e64726f6964311630140603550403130d416e64726f6964204465627567301e170d3134303132343033313333305a170d3434303131373033313333305a3037310b30090603550406130255533110300e060355040a1307416e64726f6964311630140603550403130d416e64726f696420446562756730820122300d06092a864886f70d01010105000382010f003082010a028201010094815a3e9936c11c5795eae41fd350a4a2b69b132977e44b15f071eaf170f8937ae2cf290a6b70eeb753807bc4055bb3c9ed6b661a6c99ecb3f2b8e2a1b70d00669a2f53ae9ec47f7dc64cf470b31b8486f18f7d57fc5089d059e5949041eb99ddcb9b3b0baf31baac4c1c0074658104be9866fdb909d854864605b36d8f4bfa0ff69cb428e09a660100d2be8fe3cd6996cc42d37d2987eae4fb72153f5ce3c7de0c4571251396de33ee4f596443067b7ce64384f2cdd4ee9d7383d249367e7e100e6fb857994d8a18a1da6f8b8f3100da90b8c988aa5cd48ddc909fe87d181d4ca16b6a0854d1f3876dd37b43b19b0c20872ca1c42c03d46ed5c49fb0e43cf30203010001a321301f301d0603551d0e04160414ccf203a66e9ec22720802d11c4c4de776810be0b300d06092a864886f70d01010b05000382010100869f8f832661287401adc2b59a4d4efd771efda8b9d5608ac908cb3efe0a3bdfedf13c03baf777294baa1b34e0bcaa8e412f1b38a876d05384a406d42e44b6e1aa48fdef8824a7ebb69677989d31db26a1a9a7bacc8dc40da17555d0ca55eb18c52955c97cc36c1dbf4f7f0b1774a1af0fba4cb06f4a1dfa2e2d8c64ce466697380b77558a6e1cf43d4269e33f176b8bea4ef31214e6f43b6b5fe23d15b6ac1ae1a696dece48f40472b36f1b11d99b87d849e52a3f72f03bcd075706e6df01f428af6cacce13ade9b5d4f694f003e4eaa147ecd86f7ed999cef27758733dd99d12e5d1873c450fb868864e481c49d964cd6132d2c4d3abd0a251637f2dfffe99"
// Certificate for key specified at build time
#define BUILD_CERT "@MBP_SIGN_JAVA_CERT_HEX@"

std::vector<std::string> valid_certs{
    RELEASE_CERT,
    CI_CERT,
    BUILD_CERT
};